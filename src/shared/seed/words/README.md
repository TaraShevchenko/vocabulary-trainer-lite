# Words Seed Scripts

Этот модуль содержит скрипты для заполнения и очистки данных о словах и группах слов в базе данных.

## Файлы

- `seed.ts` - Скрипт для заполнения базы данных словами и группами из CSV файла
- `clear.ts` - Скрипт для очистки всех данных о словах и группах
- `README.md` - Документация (этот файл)

## Использование

### Заполнение базы данных

```bash
# Запуск seed скрипта
npx tsx src/shared/seed/words/seed.ts
```

### Очистка базы данных

```bash
# Запуск скрипта очистки
npx tsx src/shared/seed/words/clear.ts
```

### Программное использование

```typescript
import { seedWordsAndGroups, clearWordsAndGroups } from '@/shared/seed/words/seed';
import { clearWordsAndGroups } from '@/shared/seed/words/clear';

// Заполнение данными
await seedWordsAndGroups();

// Очистка данных
await clearWordsAndGroups();
```

## Структура данных

### CSV файл

Исходные данные находятся в файле `src/shared/seed/.data/grouped_words.csv` в формате:

```csv
group_name,word
Judgment & Mindfulness,judgment
Judgment & Mindfulness,immersion
Resilience & Toughness,foster
```

### Модели базы данных

#### WordGroup
- `id` - Уникальный идентификатор группы
- `name` - Название группы (уникальное)
- `description` - Описание группы
- `createdAt` - Дата создания
- `updatedAt` - Дата обновления

#### Word
- `id` - Уникальный идентификатор слова
- `english` - Английское слово
- `russian` - Русский перевод (опционально)
- `groupId` - ID группы, к которой принадлежит слово
- `createdAt` - Дата создания
- `updatedAt` - Дата обновления

#### Progress
- `id` - Уникальный идентификатор записи прогресса
- `score` - Прогресс изучения слова (0-100)
- `userId` - ID пользователя
- `wordId` - ID слова
- `createdAt` - Дата создания
- `updatedAt` - Дата обновления

## Особенности

1. **Безопасность**: Скрипты проверяют существование записей перед созданием
2. **Транзакции**: Операции выполняются безопасно с обработкой ошибок
3. **Логирование**: Подробные логи процесса выполнения
4. **Связи**: Правильная обработка связей между таблицами при удалении

## Индексы

Для оптимизации производительности созданы следующие индексы:

- `WordGroup.name` - для быстрого поиска групп по названию
- `Word.groupId` - для быстрого получения слов группы
- `Word.english` - для поиска по английским словам
- `Progress.userId` - для получения прогресса пользователя
- `Progress.wordId` - для получения прогресса по слову
- `Progress.score` - для эффективного расчета общего прогресса

## Ограничения

- Уникальность слова в рамках группы (`english + groupId`)
- Один прогресс на пользователя на слово (`userId + wordId`)
- Каскадное удаление при удалении группы или пользователя