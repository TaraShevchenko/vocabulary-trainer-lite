# VOCABULARY TRAINER LITE - АРХИТЕКТУРА

## ОБЗОР СИСТЕМЫ

Vocabulary Trainer Lite - это веб-приложение для изучения английских слов с системой прогресса и различными типами упражнений, построенное на T3 Stack с современными технологиями.

## ТЕХНИЧЕСКИЙ СТЕК

### Frontend

- **Next.js 15** - React фреймворк с App Router
- **React 19** - UI библиотека
- **TypeScript** - типизированный JavaScript
- **Tailwind CSS** - utility-first CSS фреймворк
- **Radix UI** - компоненты UI с accessibility
- **React Hook Form** - управление формами
- **Zod** - валидация схем

### Backend

- **Prisma** - ORM для работы с базой данных
- **PostgreSQL** - реляционная база данных
- **Server Actions** - серверные действия Next.js

### Авторизация и Аутентификация

- **Clerk** - сервис аутентификации
- Поддержка социальных входов
- Управление пользователями и сессиями

### Инфраструктура

- **Vercel** - платформа для деплоя и хостинга приложения
- **Neon** - платформа для деплоя и хостинга базы данных
- **ESLint + Prettier** - линтинг и форматирование

## АРХИТЕКТУРНЫЕ ПРИНЦИПЫ

### Структура проекта (Feature-Sliced Design) ✅ РЕАЛИЗОВАНО

```
src/
├── app/                    # Next.js App Router
│   ├── page.tsx           # ✅ Дашборд с группами
│   ├── exercises/         # ✅ Страницы упражнений
│   │   └── [groupId]/
│   │       └── page.tsx   # ✅ Единая страница с ExerciseSession
│   ├── layout.tsx         # ✅ Корневой layout с аутентификацией
│   └── globals.css        # ✅ Глобальные стили
├── modules/               # ✅ Бизнес-логика по модулям
│   ├── groups/           # ✅ Управление группами слов
│   │   ├── model/
│   │   │   └── router.groups.ts  # ✅ tRPC роутер
│   │   ├── ui/
│   │   │   ├── GroupsList.tsx     # ✅ Список групп на дашборде
│   │   │   └── GroupCard.tsx      # ✅ Карточка группы с прогрессом
│   │   └── index.ts              # ✅ Экспорты модуля
│   └── exercises/        # ✅ Система упражнений
│       ├── model/
│       │   └── router.exercises.ts # ✅ tRPC роутер
│       ├── ui/
│       │   ├── MatchingExercise.tsx    # ✅ Сопоставление
│       │   ├── MultipleChoiceExercise.tsx # ✅ Множественный выбор
│       │   ├── TypingExercise.tsx      # ✅ Ввод перевода
│       │   └── ExerciseSession.tsx     # ✅ Управление сессией
│       └── index.ts              # ✅ Экспорты модуля
├── shared/               # ✅ Общие компоненты и утилиты
│   ├── api/             # ✅ API утилиты
│   │   ├── root.ts      # ✅ Корневой tRPC роутер
│   │   └── trpc.ts      # ✅ tRPC клиент
│   ├── ui/              # ✅ shadcn/ui компоненты
│   │   ├── button.tsx   # ✅ Кнопка
│   │   ├── card.tsx     # ✅ Карточка
│   │   ├── input.tsx    # ✅ Поле ввода
│   │   ├── toast.tsx    # ✅ Уведомления
│   │   └── ...          # ✅ Другие UI компоненты
│   ├── utils/           # ✅ Вспомогательные функции
│   │   └── cn.ts        # ✅ Утилита для классов
│   ├── types/           # ✅ Общие типы
│   │   └── index.ts     # ✅ Экспорт типов
│   ├── constants/       # ✅ Константы
│   │   └── index.ts     # ✅ Общие константы
│   ├── config/          # ✅ Конфигурация
│   │   └── database.ts  # ✅ Prisma клиент
│   └── seed/            # ✅ Скрипты заполнения БД
│       ├── words/       # ✅ Seed для слов
│       └── users/       # ✅ Синхронизация пользователей
└── widgets/             # ❌ Пустая папка (не используется)
```

### Принципы организации кода

- **Feature-Sliced Design** - модульная архитектура
- **Type Safety** - строгая типизация на всех уровнях
- **Server Components** - использование RSC где возможно
- **Progressive Enhancement** - работа без JavaScript
- **Separation of Concerns** - разделение логики по слоям

## МОДЕЛЬ ДАННЫХ

### Основные сущности

#### User (Пользователь)

- Интеграция с Clerk для аутентификации
- Связь с группами слов и прогрессом
- Персональные настройки обучения

#### WordGroup (Группа слов)

- Название и описание группы
- Принадлежность пользователю
- Список слов в группе
- Метаданные (дата создания, количество слов)

#### Word (Слово)

- Английское слово
- Русский перевод
- Принадлежность к группе
- Дополнительная информация (транскрипция, примеры)

#### Progress (Прогресс изучения слова)

- Связь пользователя и слова (составной ключ)
- Текущий процент изучения (0-100%)
- Дата последнего изучения
- Дневной прирост прогресса (ограничение 50%)
- Автоматическое снижение через 2 дня

### Связи между сущностями

- User → WordGroup (один ко многим)
- WordGroup → Word (один ко многим)
- User + Word → Progress (один к одному)
- Каскадное удаление при удалении пользователя или слова

### Реализованные ограничения

- Уникальность слова в рамках группы
- Один прогресс на пользователя на слово
- Индексы для оптимизации запросов
- Валидация данных через Zod схемы

## ТИПЫ УПРАЖНЕНИЙ

### 1. Сопоставление (Matching)

- Две колонки: английские слова и русские переводы
- Простой интерфейс с кликами: пользователь выбирает слово в одной колонке, затем соответствующее слово в другой колонке
- После выбора слова в одной колонке, эта колонка блокируется до выбора пары
- Мгновенная обратная связь: правильный ответ увеличивает прогресс слова, неправильный - уменьшает
- Проверка каждого сопоставления по мере выбора

### 2. Множественный выбор (Multiple Choice)

- Показывается английское слово
- 4 варианта русского перевода
- Один правильный ответ

### 3. Ввод перевода (Typing)

- Показывается русское слово
- Нужно ввести английский перевод
- Проверка с учетом регистра и опечаток

## СИСТЕМА ПРОГРЕССА

### Логика изменения прогресса

- **Правильный ответ**: +10% (максимум 50% в день)
- **Неправильный ответ**: -5%
- **Автоматическое снижение**: -10% каждые 2 дня
- **Завершенные слова**: 100% прогресс = исключение из упражнений

### Ограничения

- Максимум 50% прогресса в день на слово
- Минимум 0%, максимум 100%
- Отслеживание времени последнего изучения

## ПОЛЬЗОВАТЕЛЬСКИЙ ИНТЕРФЕЙС

### Дашборд

- Карточки групп слов с ключевой информацией:
  - Название группы
  - Количество слов в группе
  - Общий процент прогресса по всем словам группы
- Клик по карточке ведет сразу к выбору типа упражнения

### Страницы упражнений

- Выбор типа упражнения (`/exercises/[groupId]`)
- Интерактивные упражнения по типам
- Система обратной связи
- Отображение прогресса сессии
- После завершения - автоматический возврат на дашборд

### Упрощенная навигация

- Минималистичная шапка: только логотип для возврата на дашборд
- Прямой переход: с дашборда сразу к упражнениям
- Автоматический возврат: после завершения упражнений на дашборд
- Сохранение прогресса: после каждого выполненного упражнения

## БЕЗОПАСНОСТЬ

### Аутентификация

- Clerk обрабатывает все аспекты аутентификации
- JWT токены для API запросов
- Middleware для защиты роутов

### Авторизация

- Row Level Security через Prisma
- Проверка прав доступа на уровне Server Actions
- Изоляция данных между пользователями

### Валидация данных

- Zod схемы для всех входных данных
- Санитизация пользовательского ввода
- Проверка типов на compile-time

## ПРОИЗВОДИТЕЛЬНОСТЬ

### Оптимизации

- Server Components для статического контента
- Lazy loading компонентов упражнений
- Оптимизация запросов к БД
- Кэширование результатов

### Мониторинг

- Встроенная аналитика Next.js
- Error boundaries для обработки ошибок
- Логирование прогресса обучения

## ТЕКУЩИЙ СТАТУС ПРОЕКТА

### ✅ Фаза 1: Базовая функциональность (ЗАВЕРШЕНА)

1. ✅ Модель данных и миграции - полная схема БД с User, WordGroup, Word, Progress
2. ✅ Система аутентификации - Clerk интеграция с защитой роутов
3. ✅ Управление группами слов - дашборд с карточками групп, избранное
4. ✅ Базовые упражнения - сопоставление, множественный выбор, ввод перевода
5. ✅ Система прогресса - дифференцированный алгоритм, автосохранение

### 🔄 Фаза 2: Улучшения UX (ЧАСТИЧНО)

1. ✅ Адаптивный дизайн - базовая адаптивность реализована
2. 🔄 Анимации и переходы - частично реализованы
3. ❌ Звуковые эффекты - не реализованы
4. ❌ Темная тема - не реализована

### ❌ Фаза 3: Расширенные возможности (НЕ НАЧАТА)

1. Статистика и аналитика
2. Экспорт/импорт словарей
3. Настройки сложности
4. Система достижений

### Будущие возможности

- Произношение слов (Text-to-Speech)
- Мобильное приложение
- Социальные функции
- AI-помощник для изучения
- Интеграция с внешними словарями

## ПРИОРИТЕТЫ РАЗВИТИЯ

### Ближайшие задачи
1. Завершение UX улучшений (темная тема, анимации)
2. Добавление тестов (покрытие > 80%)
3. Оптимизация производительности (Lighthouse > 90)
4. Улучшение мобильной версии

### Среднесрочные цели
1. Статистика обучения
2. Дополнительные типы упражнений
3. Настройки пользователя
4. Система достижений
