# АРХИТЕКТУРА ПРИЛОЖЕНИЯ MEAL PLANNER

## ОБЗОР СИСТЕМЫ

Meal Planner - это веб-приложение для планирования питания и учета продуктов, построенное на T3 Stack с современными технологиями.

## ТЕХНИЧЕСКИЙ СТЕК

### Frontend

- **Next.js 15** - React фреймворк с App Router
- **React 19** - UI библиотека
- **TypeScript** - типизированный JavaScript
- **Tailwind CSS** - utility-first CSS фреймворк
- **Radix UI** - компоненты UI с accessibility
- **React Hook Form** - управление формами
- **Zod** - валидация схем

### Backend

- **tRPC** - type-safe API
- **Prisma** - ORM для работы с базой данных
- **PostgreSQL** - реляционная база данных
- **Neon** - serverless PostgreSQL хостинг

### Авторизация и Аутентификация

- **Clerk** - сервис аутентификации
- Поддержка социальных входов
- Управление пользователями и сессиями

### Инфраструктура

- **[Vercel](https://vercel.com)** - Платформа для деплоя и хостинга приложения
- **[Neon](https://neon.com)** - Платформа для деплоя и хостинга базы данных
- **ESLint + Prettier** - линтинг и форматирование

## АРХИТЕКТУРНЫЕ ПРИНЦИПЫ

### Структура проекта

```
src/
├── app/                 # Next.js App Router
│   ├── api/            # API маршруты
│   ├── login/          # Страница входа
│   ├── register/       # Страница регистрации
│   └── layout.tsx      # Корневой layout
├── modules/            # Бизнес-логика по модулям
│   └── example/        # Пример структуры модуля
│       ├── index.ts    # Публичный API модуля (экспорты)
│       ├── model/      # Бизнес-логика и данные
│       │   ├── types.example.ts    # TypeScript типы и Zod схемы
│       │   ├── hooks.example.ts    # React Query хуки
│       │   └── router.example.ts   # tRPC роутер (импортировать напрямую, не ложить в пуб. экспорты)
│       └── ui/         # UI компоненты модуля
│           ├── ExampleComponent.ts # Любой UI компонент относящийся к этой сущности
│           ├── ExampleTable.ts     # Таблица сущности
│           └── ExampleForm.tsx     # Форма для работы с сущностью
├── shared/             # Общие компоненты и утилиты
│   ├── api/           # tRPC конфигурация
│   ├── config/        # Конфигурация приложения
│   ├── ui/            # Переиспользуемые UI компоненты
│   └── utils/         # Утилиты и хелперы
└── widgets/           # Составные компоненты
```

### Принципы организации кода

- **Feature-Sliced Design** - модульная архитектура
- **Type Safety** - строгая типизация на всех уровнях
- **Server Components** - использование RSC где возможно
- **Progressive Enhancement** - работа без JavaScript

## МОДЕЛЬ ДАННЫХ

### Основные сущности

#### User (Пользователь)

- Интеграция с Clerk для аутентификации
- Дополнительные поля для профиля
- Связь с семейными группами

#### Recipe (Рецепт)

- Название и описание
- Список ингредиентов с количеством
- Пищевая ценность
- Время приготовления
- Выход готового блюда

#### Ingredient (Ингредиент)

- Базовая информация о продукте
- Пищевая ценность на 100г
- Возможные фасовки для покупки
- Категория продукта

#### MealPlan (План питания)

- Привязка к пользователю/семье
- Дата и время приема пищи
- Список блюд с порциями
- Статус выполнения

#### QuickMeal (Быстрое блюдо)

- Приблизительная пищевая ценность
- Место употребления (ресторан, кафе)
- Фото блюда (опционально)

### Связи между сущностями

- User ↔ Family (многие ко многим)
- User → MealPlan (один ко многим)
- Recipe → Ingredient (многие ко многим через RecipeIngredient)
- MealPlan → Recipe/QuickMeal (многие ко многим)

## БЕЗОПАСНОСТЬ

### Аутентификация

- Clerk обрабатывает все аспекты аутентификации
- JWT токены для API запросов
- Middleware для защиты роутов

### Авторизация

- Row Level Security через Prisma
- Проверка прав доступа на уровне tRPC
- Изоляция данных между пользователями/семьями

### Валидация данных

- Zod схемы для всех входных данных
- Санитизация пользовательского ввода
- Проверка типов на compile-time

## ПРОИЗВОДИТЕЛЬНОСТЬ

### Оптимизации

- Server Components для статического контента
- Lazy loading компонентов
- Оптимизация изображений через Next.js
- Кэширование на уровне tRPC

### Мониторинг

- Встроенная аналитика Next.js
- Error boundaries для обработки ошибок
- Логирование критических операций

## ПЛАНЫ РАЗВИТИЯ

### Ближайшие задачи

1. Развертывание продакшен версии
2. Базовый дашборд с авторизацией
3. Система планирования питания
4. Управление рецептами и ингредиентами

### Будущие возможности

- Распознавание блюд по фото (AI)
- Учет микронутриентов и витаминов
- Интеграция с фитнес-трекерами
- Мобильное приложение
- Социальные функции (обмен рецептами)
